# TEMPLATE - Do not edit directly
#
# Usage:
#   1. Configure .env (see .env.example)
#   2. task argocd:generate-secrets
#
# This generates secrets.sops.yaml with random passwords and encrypts it.
# Only AWS credentials and AGE key are read from .env.
---
# Route53 credentials for cert-manager DNS01 challenge
apiVersion: v1
kind: Secret
metadata:
  name: route53-credentials
  namespace: cert-manager
type: Opaque
stringData:
  access-key-id: REPLACE_ME
  secret-access-key: REPLACE_ME
  hosted-zone-id: REPLACE_ME
---
# Keycloak admin and database credentials
apiVersion: v1
kind: Secret
metadata:
  name: keycloak-secrets
  namespace: keycloak
type: Opaque
stringData:
  admin-password: REPLACE_ME
  db-username: keycloak
  db-password: REPLACE_ME
---
# OIDC client secrets for Keycloak realm (used by operator)
# These must match what's configured in Grafana and ArgoCD
apiVersion: v1
kind: Secret
metadata:
  name: oidc-client-secrets
  namespace: keycloak
type: Opaque
stringData:
  grafana: REPLACE_ME
  argocd: REPLACE_ME
---
# PostgreSQL credentials (must match keycloak db-password)
apiVersion: v1
kind: Secret
metadata:
  name: postgres-credentials
  namespace: postgres
type: kubernetes.io/basic-auth
stringData:
  username: keycloak
  password: REPLACE_ME
---
# Grafana admin credentials
apiVersion: v1
kind: Secret
metadata:
  name: grafana-admin
  namespace: monitoring
type: Opaque
stringData:
  admin-user: admin
  admin-password: REPLACE_ME
---
# Grafana OAuth client secret (injected as env var)
apiVersion: v1
kind: Secret
metadata:
  name: grafana-oauth
  namespace: monitoring
type: Opaque
stringData:
  GF_AUTH_GENERIC_OAUTH_CLIENT_SECRET: REPLACE_ME
---
# ArgoCD secret (replaces Helm-generated argocd-secret)
# Contains OIDC client secret and other ArgoCD secrets
apiVersion: v1
kind: Secret
metadata:
  name: argocd-secret
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-secret
    app.kubernetes.io/part-of: argocd
type: Opaque
stringData:
  # OIDC client secret for Keycloak (referenced as $oidc.keycloak.clientSecret in OIDC config)
  oidc.keycloak.clientSecret: REPLACE_ME
---
# SOPS AGE key for ArgoCD repo-server decryption
apiVersion: v1
kind: Secret
metadata:
  name: sops-age-key
  namespace: argocd
type: Opaque
stringData:
  keys.txt: |
    # AGE-SECRET-KEY-REPLACE_ME
